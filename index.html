<!DOCTYPE html>
<html>
<head>
  <title>Redirecting</title>
  <script src="https://statics.teams.cdn.office.net/sdk/v1.10.0/js/MicrosoftTeams.min.js"></script>
</head>
<body>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      microsoftTeams.initialize();

      // Your deep link to the Teams channel, tab, or app
      const deepLinkUrl = "https://teams.microsoft.com/l/entity/2a527703-1f6f-4559-a332-d8a7d288cd88/_djb2_msteams_prefix_1573395180?context=%7B%22channelId%22%3A%2219%3ARCrLj4NC_rswzh6aSowcowBlOeByFKkR21Qs9U75_e01%40thread.tacv2%22%7D&tenantId=2965b672-227f-448f-bbb2-cb113e23ac9a";

      // Check if we've already redirected once in this session
      if (!sessionStorage.getItem("alreadyRedirected")) {
        // First time on this page => set marker and execute the deep link
        sessionStorage.setItem("alreadyRedirected", "true");
        microsoftTeams.executeDeepLink(deepLinkUrl);
      } else {
        // Weâ€™ve been here before, so the user is likely pressing "Back"
        // or returning from the Teams tab -> push them one more step back
        // so they don't get stuck on this page.
        history.back();
        history.back();
      }
    });
  </script>
</body>
</html>
